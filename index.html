<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡¶™‡ßç‡¶∞‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶∏‡ßá‡¶¨‡¶æ ‚Äî ‡¶∏‡¶π‡¶ú ‡¶∏‡ßá‡¶¨‡¶æ</title>

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#00796b">
  <link rel="apple-touch-icon" href="icons/icon-192.png">

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <style>
    body {
      margin: 0;
      font-family: "Inter", "Noto Sans Bengali", sans-serif;
      background: linear-gradient(180deg, #f9fafb, #ecf0f1);
      color: #0b2540;
      padding-top: 100px;
    }

    /* ‡¶ò‡ßã‡¶∑‡¶£‡¶æ ‡¶¨‡¶æ‡¶∞ */
    .announcement-bar {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 95%;
      max-width: 900px;
      background: linear-gradient(135deg, #00796b, #26a69a, #ffb300);
      color: #fff;
      border-radius: 20px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25);
      padding: 10px 15px;
      text-align: center;
      z-index: 1000;
      backdrop-filter: blur(10px);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 6px;
    }

    .announcement-text {
      flex: 1;
      text-align: center;
    }

    .announcement-title {
      font-size: 16px;
      font-weight: 800;
      color: #ffffff;
      margin-bottom: 3px;
    }

    .announcement-message {
      font-size: 14px;
      font-weight: 600;
      padding: 6px 10px;
      border-radius: 10px;
      display: inline-block;
      transition: background 0.6s ease, color 0.6s ease;
    }

    /* Grid Layout */
    .wrap {
      max-width: 1000px;
      margin: auto;
      padding: 15px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 12px;
    }

    /* ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶ï‡¶æ‡¶∞‡ßç‡¶° */
    .service-card {
      background: #ffffff;
      border-radius: 15px;
      padding: 12px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.07);
      border: 1px solid #e5e7eb;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 250px;
    }

    .service-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
    }

    .service-title {
      font-size: 16px;
      font-weight: 700;
      text-align: center;
      background: linear-gradient(90deg, #00796b, #00bfa5);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 5px;
    }

    .service-details {
      background: linear-gradient(135deg, #eef2f3, #dfe9f3);
      color: #2c3e50;
      font-size: 13px;
      line-height: 1.4;
      border-radius: 10px;
      padding: 8px;
      box-shadow: inset 0 0 6px rgba(0,0,0,0.05);
      border-left: 3px solid #26a69a;
      flex-grow: 1;
      overflow: hidden;
    }

    .service-image {
      width: 100%;
      height: 90px;
      object-fit: contain;
      border-radius: 10px;
      background-color: #f8fafc;
      margin-top: 6px;
    }

    .service-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 6px;
    }

    .contact-icons {
      display: flex;
      gap: 6px;
    }

    .contact-icons a {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 14px;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .contact-icons a:hover {
      transform: scale(1.1);
      box-shadow: 0 0 10px rgba(0,0,0,0.25);
    }

    .whatsapp { background: #25D366; }
    .phone { background: #00796b; }
    .telegram { background: #229ED9; }
    .facebook { background: #1877F2; }

    .price-tag {
      padding: 4px 10px;
      border-radius: 15px;
      background: linear-gradient(90deg, #00796b, #26a69a);
      color: #ffffff;
      font-weight: 600;
      font-size: 12px;
      box-shadow: 0 3px 10px rgba(0, 121, 107, 0.3);
    }

    /* üß≠ ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶° ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶ï‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶® */
    .support-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: linear-gradient(135deg, #00796b, #00bfa5);
      color: #fff;
      font-weight: 700;
      font-size: 14px;
      padding: 12px 18px;
      border-radius: 30px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.25);
      display: flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
      z-index: 1500;
      transition: all 0.3s ease;
    }

    .support-button:hover {
      transform: scale(1.08);
      box-shadow: 0 10px 25px rgba(0,0,0,0.35);
    }

    .support-button i {
      font-size: 18px;
    }

    /* ‚úÖ ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶° ‡¶¨‡¶æ‡¶ü‡¶®: ‡¶è‡¶ï‡¶¶‡¶Æ ‡¶â‡¶™‡¶∞‡ßá-‡¶°‡¶æ‡¶®‡ßá (‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§) */
    .fixed-top-right {
      position: fixed;
      top: 10px; /* ‚ö†Ô∏è ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
      right: 20px;
      background: linear-gradient(135deg, #ff9800, #ffb74d);
      color: #fff;
      
      /* ‡¶¨‡¶æ‡¶ü‡¶®‡¶ü‡¶ø‡¶ï‡ßá ‡¶õ‡ßã‡¶ü ‡¶ì ‡¶ó‡ßã‡¶≤‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá */
      width: 40px; 
      height: 40px;
      border-radius: 50%;
      
      /* ‡¶Ü‡¶á‡¶ï‡¶®‡¶ï‡ßá ‡¶Æ‡¶æ‡¶ù‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶®‡¶§‡ßá */
      display: flex;
      justify-content: center;
      align-items: center;

      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
      z-index: 1001; /* ‡¶ò‡ßã‡¶∑‡¶£‡¶æ ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ (1000) ‡¶â‡¶™‡¶∞‡ßá ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
    }

    .fixed-top-right:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 15px rgba(0,0,0,0.3);
    }

    .fixed-top-right i {
      font-size: 16px;
    }

    /* -----------------------
       Added Contact Dialog styles
       (will not modify existing logic)
       ----------------------- */
    /* Overlay */
    .contact-overlay {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.32);
      backdrop-filter: blur(6px);
      z-index: 2000;
      padding: 18px;
    }

    .contact-overlay.open {
      display: flex;
    }

    /* Dialog card */
    .contact-dialog {
      width: 100%;
      max-width: 420px;
      background: #ffffff;
      border-radius: 18px;
      border: 1px solid #FFF2DC; /* ‡¶π‡¶æ‡¶≤‡¶ï‡¶æ ‡¶ï‡ßç‡¶∞‡¶ø‡¶Æ ‡¶¨‡¶∞‡ßç‡¶°‡¶æ‡¶∞ */
      box-shadow: 0 12px 40px rgba(10,10,10,0.12);
      padding: 18px;
      box-sizing: border-box;
      transform: translateY(10px);
      animation: dialogIn 220ms ease forwards;
    }

    @keyframes dialogIn {
      from { opacity: 0; transform: translateY(18px) scale(0.98); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .dialog-header {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .dialog-icon {
      width: 56px;
      height: 56px;
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      flex-shrink: 0;
      box-shadow: 0 6px 18px rgba(255,123,0,0.12);
      background: linear-gradient(135deg, #FFF3E0, #FFEBCC);
      color: #FF7B00;
    }

    .dialog-title {
      font-size: 18px;
      font-weight: 800;
      color: #FF7B00;
      margin: 0;
    }

    .dialog-sub {
      margin: 2px 0 0 0;
      font-size: 13px;
      color: #555;
    }

    .dialog-body {
      margin-top: 14px;
    }

    .contact-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      padding: 10px;
      border-radius: 12px;
      background: linear-gradient(180deg, #fff, #fff);
      border: 1px solid #f1f1f1;
    }

    .contact-text {
      font-weight: 700;
      color: #333;
      font-size: 15px;
      word-break: break-word;
      max-width: calc(100% - 64px);
    }

    .contact-actions {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    /* Copy button */
    .btn-copy {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(135deg, #FFB347, #FF7B00);
      color: #fff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      box-shadow: 0 8px 20px rgba(255,123,0,0.2);
      cursor: pointer;
      transition: transform 140ms ease, box-shadow 140ms ease;
    }

    .btn-copy:active { transform: scale(0.98); }
    .btn-copy:focus { outline: none; box-shadow: 0 0 0 4px rgba(255,123,0,0.12); }

    /* Close button */
    .btn-close {
      margin-top: 12px;
      width: 100%;
      background: #FFEFD5;
      color: #FF7B00;
      border: none;
      padding: 10px 12px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(255,123,0,0.06);
    }

    .btn-close:active { transform: translateY(1px); }

    .dialog-note {
      margin-top: 10px;
      font-size: 13px;
      color: #666;
      line-height: 1.3;
    }

    /* small toast for copy confirm */
    .copy-toast {
      position: fixed;
      bottom: 26px;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: #fff;
      padding: 10px 14px;
      border-radius: 22px;
      font-size: 13px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.3);
      opacity: 0;
      pointer-events: none;
      z-index: 3000;
      transition: opacity 180ms ease, transform 180ms ease;
    }

    .copy-toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
      pointer-events: auto;
    }

    @media (max-width:420px) {
      .contact-dialog { padding: 14px; border-radius: 14px; }
      .dialog-icon { width: 48px; height: 48px; font-size: 20px; border-radius: 12px; }
      .btn-copy { width: 40px; height: 40px; }
    }

  </style>
</head>
<body>

  <div class="announcement-bar">
    <div class="announcement-text">
      <div class="announcement-title" id="announcementTitle">‚ú® ‡¶ò‡ßã‡¶∑‡¶£‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
      <div class="announcement-message" id="announcementMessage">‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...</div>
    </div>
  </div>

  <div class="wrap" id="servicesList">
    <div class="service-card">‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
  </div>

  <a href="https://wa.me/message/5HX345GEYAHVO1" target="_blank" class="support-button">
    <i class="fas fa-headset"></i> ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶ï‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü
  </a>
  
  <a href="#" id="fixedAnnouncementLink" class="fixed-top-right" target="_blank" style="display:none;">
    <i class="fas fa-link"></i>
  </a>


  <script>
  const SUPABASE_URL = "https://nzgejzlapyykhvcpypyr.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im56Z2VqemxhcHl5a2h2Y3B5cHlyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5ODE1MzksImV4cCI6MjA3NzU1NzUzOX0.JxXyESc-Y7VEi9WH2XkiXQIj8BgY-nzYOpfprMqIx4Y";
  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  const servicesList = document.getElementById("servicesList");
  const announcementTitle = document.getElementById("announcementTitle");
  const announcementMessage = document.getElementById("announcementMessage");
  
  // ‚úÖ ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶° ‡¶¨‡¶æ‡¶ü‡¶®‡ßá‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø
  const fixedAnnouncementLink = document.getElementById("fixedAnnouncementLink");


  const messageColors = [
    { bg: "#E3F2FD", color: "#0D47A1" },
    { bg: "#FFF3E0", color: "#E65100" },
    { bg: "#E8F5E9", color: "#1B5E20" },
    { bg: "#F3E5F5", color: "#4A148C" },
    { bg: "#FCE4EC", color: "#880E4F" },
    { bg: "#E0F7FA", color: "#006064" },
    { bg: "#FFFDE7", color: "#F57F17" }
  ];
  const randomColor = messageColors[Math.floor(Math.random() * messageColors.length)];
  announcementMessage.style.background = randomColor.bg;
  announcementMessage.style.color = randomColor.color;

  async function loadServices(){
  const contact = await loadContacts(); // ‚úÖ ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶ó‡ßá ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßã

  const { data, error } = await supabase.from("services").select("*").order("timestamp", { ascending: false });
  if(error){ servicesList.innerHTML = `<div class="service-card">‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ${error.message}</div>`; return; }
  if(!data.length){ servicesList.innerHTML = `<div class="service-card">‡¶ï‡ßã‡¶® ‡¶∏‡ßá‡¶¨‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</div>`; return; }

  servicesList.innerHTML = data.map(s => `
    <div class="service-card">
      <div class="service-title">${s.name}</div>
      <div class="service-details">${s.description || ''}</div>
      ${s.image_url ? `<img class="service-image" src="${s.image_url}" alt="Service Image" />` : ''}
      <div class="service-footer">
        <div class="contact-icons">
          <a href="${contact.whatsapp}" target="_blank" class="whatsapp"><i class="fab fa-whatsapp"></i></a>
          <a href="${contact.phone}" class="phone"><i class="fas fa-phone"></i></a>
          <a href="${contact.telegram}" target="_blank" class="telegram"><i class="fab fa-telegram"></i></a>
          <a href="${contact.facebook}" target="_blank" class="facebook"><i class="fab fa-facebook-f"></i></a>
        </div>
        <div class="price-tag">${s.price ? `‡ß≥ ${s.price}` : '‡¶´‡ßç‡¶∞‡¶ø'}</div>
      </div>
    </div>
  `).join('');
}

  async function loadAnnouncements(){
    const { data, error } = await supabase.from("announcements").select("*").order("timestamp", { ascending: false });
    if(error){ announcementTitle.textContent = "‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø"; announcementMessage.textContent = error.message; return; }
    if(!data.length){ 
      announcementTitle.textContent = "‡¶ò‡ßã‡¶∑‡¶£‡¶æ ‡¶®‡ßá‡¶á"; 
      announcementMessage.textContent = "‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶ò‡ßã‡¶∑‡¶£‡¶æ ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§"; 
      fixedAnnouncementLink.style.display = "none"; 
      return; 
    }

    const latest = data[0];
    announcementTitle.textContent = latest.title || "‡¶ò‡ßã‡¶∑‡¶£‡¶æ";
    announcementMessage.textContent = latest.content || "‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶®‡ßá‡¶á‡•§";

    if(latest.link){
      fixedAnnouncementLink.href = latest.link; 
      fixedAnnouncementLink.style.display = "flex"; 
    } else {
      fixedAnnouncementLink.style.display = "none";
    }
  }
  
  // ‚úÖ ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
async function loadContacts() {
  const { data, error } = await supabase.from("contacts").select("*").eq("name", "default").single();
  if (error) {
    console.error("‚ùå ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø:", error);
    return {
      whatsapp: "https://wa.me/message/5HX345GEYAHVO1",
      phone: "tel:0531267825",
      telegram: "https://t.me/prbashi",
      facebook: "https://www.facebook.com/share/17XjEWhr8a/"
    };
  }
  return data;
}

  // ‚úÖ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶ ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤‡¶ü‡¶æ‡¶á‡¶Æ ‡¶∏‡¶æ‡¶¨‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶®
  function setupRealtimeAnnouncements() {
    try {
      const channel = supabase.channel('realtime:announcements');

      channel.on(
        'postgres_changes',
        { event: '*', schema: 'public', table: 'announcements' },
        payload => {
          console.log('üì° ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤‡¶ü‡¶æ‡¶á‡¶Æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶∏‡¶®‡¶æ‡¶ï‡ßç‡¶§:', payload);
          loadAnnouncements();
        }
      );

      channel.subscribe((status) => {
        if (status === 'SUBSCRIBED') {
          console.log('‚úÖ ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤‡¶ü‡¶æ‡¶á‡¶Æ ‡¶ò‡ßã‡¶∑‡¶£‡¶æ ‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá');
        } else if (status === 'TIMED_OUT') {
          console.warn('‚ö†Ô∏è ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶ü‡¶æ‡¶á‡¶Æ‡¶Ü‡¶â‡¶ü ‚Äî ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
          reconnectRealtime();
        } else if (status === 'CLOSED') {
          console.warn('üîå ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶¨‡¶®‡ßç‡¶ß ‚Äî ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶∏‡¶Ç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
          reconnectRealtime();
        }
      });
    } catch (error) {
      console.error('‚ùå ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤‡¶ü‡¶æ‡¶á‡¶Æ ‡¶∏‡¶æ‡¶¨‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•:', error);
      setTimeout(setupRealtimeAnnouncements, 5000);
    }
  }

  function reconnectRealtime() {
    setTimeout(() => {
      console.log('üîÑ ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó‡ßá‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ö‡¶≤‡¶õ‡ßá...');
      setupRealtimeAnnouncements();
    }, 3000);
  }

  loadServices();
  loadAnnouncements();
  setupRealtimeAnnouncements();
  </script>

  <!-- ============================
       Contact Dialog Markup & Script
       (Added WITHOUT changing any existing code/logic)
       ============================ -->
  <div id="contactOverlay" class="contact-overlay" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="contact-dialog" role="document" aria-labelledby="dialogTitle">
      <div class="dialog-header">
        <div id="dialogIcon" class="dialog-icon" aria-hidden="true">
          <i class="fas fa-phone"></i>
        </div>
        <div style="flex:1;">
          <h3 id="dialogTitle" class="dialog-title">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
          <div id="dialogSubtitle" class="dialog-sub">‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞/‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</div>
        </div>
      </div>

      <div class="dialog-body">
        <div style="height:12px;"></div>

        <div class="contact-row" aria-live="polite">
          <div id="contactText" class="contact-text">0531267825</div>
          <div class="contact-actions">
            <button id="copyBtn" class="btn-copy" aria-label="‡¶ï‡¶™‡¶ø"><i class="fas fa-copy"></i></button>
          </div>
        </div>

        <div class="dialog-note" id="dialogNote">
          ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶™‡¶ø ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞/‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßá ‡¶¨‡¶æ‡¶á‡¶∞‡ßá ‡¶ó‡¶ø‡ßü‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®‡•§
        </div>

        <button id="closeDialog" class="btn-close" aria-label="‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®">‚ùå ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</button>
      </div>
    </div>
  </div>

  <div id="copyToast" class="copy-toast" role="status" aria-live="polite">‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!</div>

  <script>
  (function(){
    // Ensure we don't interfere with existing functions/variables.
    // Attach handlers after DOM is ready and after services are rendered.
    function getServiceIconClass(el) {
      if(!el) return 'phone';
      if (el.classList.contains('whatsapp')) return 'whatsapp';
      if (el.classList.contains('telegram')) return 'telegram';
      if (el.classList.contains('facebook')) return 'facebook';
      if (el.classList.contains('phone')) return 'phone';
      return 'phone';
    }

    // Map icon class to display icon HTML & friendly title
    const ICON_MAP = {
      whatsapp: { icon: '<i class="fab fa-whatsapp"></i>', title: 'WhatsApp' },
      telegram: { icon: '<i class="fab fa-telegram"></i>', title: 'Telegram' },
      facebook: { icon: '<i class="fab fa-facebook-f"></i>', title: 'Facebook' },
      phone: { icon: '<i class="fas fa-phone"></i>', title: '‡¶´‡ßã‡¶®' }
    };

    const overlay = document.getElementById('contactOverlay');
    const dialogIcon = document.getElementById('dialogIcon');
    const dialogTitle = document.getElementById('dialogTitle');
    const dialogSubtitle = document.getElementById('dialogSubtitle');
    const contactText = document.getElementById('contactText');
    const copyBtn = document.getElementById('copyBtn');
    const closeBtn = document.getElementById('closeDialog');
    const copyToast = document.getElementById('copyToast');

    // Helper: show overlay
    function openDialog({type = 'phone', display = '', subtitle = ''}) {
      const info = ICON_MAP[type] || ICON_MAP.phone;
      dialogIcon.innerHTML = info.icon;
      dialogTitle.textContent = `${info.title} ‡¶è ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®`;
      dialogSubtitle.textContent = subtitle || '‡¶®‡¶ø‡¶Æ‡ßç‡¶®‡ßá‡¶∞ ‡¶ï‡¶™‡¶ø ‡¶¨‡¶æ‡¶ü‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®';
      contactText.textContent = display || '';
      overlay.classList.add('open');
      overlay.setAttribute('aria-hidden', 'false');

      // Focus copy button for keyboard users
      setTimeout(() => {
        copyBtn.focus();
      }, 120);
    }

    // Helper: hide overlay
    function closeDialog() {
      overlay.classList.remove('open');
      overlay.setAttribute('aria-hidden', 'true');
    }

    // Helper: show toast
    let toastTimer = null;
    function showToast(text = '‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!') {
      if (toastTimer) {
        clearTimeout(toastTimer);
        toastTimer = null;
      }
      copyToast.textContent = text;
      copyToast.classList.add('show');
      toastTimer = setTimeout(() => {
        copyToast.classList.remove('show');
        toastTimer = null;
      }, 1600);
    }

    // Copy handler
    copyBtn.addEventListener('click', async function(e){
      e.preventDefault();
      const txt = contactText.textContent.trim();
      if (!txt) {
        showToast('‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶®‡ßá‡¶á');
        return;
      }
      try {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          await navigator.clipboard.writeText(txt);
        } else {
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = txt;
          document.body.appendChild(ta);
          ta.select();
          document.execCommand('copy');
          ta.remove();
        }
        showToast('‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
      } catch (err) {
        console.error('Copy failed', err);
        showToast('‡¶ï‡¶™‡¶ø ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡ßü‡ßá‡¶õ‡ßá');
      }
    });

    // Close handlers: button, overlay click outside dialog, Escape key
    closeBtn.addEventListener('click', function(){ closeDialog(); });
    overlay.addEventListener('click', function(e){
      if (e.target === overlay) closeDialog();
    });
    document.addEventListener('keydown', function(e){
      if (e.key === 'Escape' && overlay.classList.contains('open')) {
        closeDialog();
      }
    });

    // Event delegation for contact icon clicks inside servicesList
    // We intercept clicks on any anchor inside .contact-icons and show dialog.
    document.addEventListener('click', async function(evt){
      const a = evt.target.closest && evt.target.closest('.contact-icons a');
      if (!a) return;

      // Prevent default navigation so dialog shows first
      evt.preventDefault();
      evt.stopPropagation();

      // Determine type by class on the anchor or by href
      let type = 'phone';
      if (a.classList.contains('whatsapp')) type = 'whatsapp';
      else if (a.classList.contains('telegram')) type = 'telegram';
      else if (a.classList.contains('facebook')) type = 'facebook';
      else if (a.classList.contains('phone')) type = 'phone';
      else {
        // fallback by href
        const h = (a.getAttribute('href') || '').toLowerCase();
        if (h.startsWith('tel:')) type = 'phone';
        else if (h.includes('wa.me') || h.startsWith('whatsapp:')) type = 'whatsapp';
        else if (h.includes('t.me') || h.startsWith('tg:')) type = 'telegram';
        else if (h.includes('facebook.com')) type = 'facebook';
      }

      // Determine display text (phone number or link)
      const href = a.getAttribute('href') || '';
      let display = href;

      // if tel: remove tel:
      if (href.startsWith('tel:')) {
        display = href.replace(/^tel:/i, '');
      } else if (href.startsWith('mailto:')) {
        display = href.replace(/^mailto:/i, '');
      } else {
        // keep as is for links like https://wa.me/...
        display = href;
      }

      // Get helpful subtitle (if contact data available from loadContacts)
      let subtitle = '';
      try {
        // Try to read contacts from supabase via existing loadContacts()
        // (we call the function if available; if not, ignore)
        if (typeof loadContacts === 'function') {
          const data = await loadContacts();
          // pick suitable subtitle based on type
          if (type === 'whatsapp' && data && data.whatsapp) subtitle = '‡¶Ü‡¶™‡¶®‡¶ø WhatsApp-‡¶è ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶™‡¶æ‡¶†‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®';
          else if (type === 'telegram' && data && data.telegram) subtitle = '‡¶Ü‡¶™‡¶®‡¶ø Telegram-‡¶è ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶™‡¶æ‡¶ö‡ßç‡¶õ‡ßá‡¶®';
          else if (type === 'facebook' && data && data.facebook) subtitle = 'Facebook-‡¶è ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶™‡ßá‡¶ú‡ßá ‡¶Ø‡¶æ‡¶®';
          else if (type === 'phone' && data && data.phone) subtitle = '‡¶∏‡ßã‡¶ú‡¶æ ‡¶´‡ßã‡¶®‡ßá ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®';
        }
      } catch (err) {
        // ignore, don't break UX
      }

      // Show dialog
      openDialog({ type, display, subtitle });
    });

    // Also intercept clicks for the fixedAnnouncementLink if needed
    // (Optional ‚Äî but we won't block it; only if you want dialog on it change logic)
    // Note: we intentionally do NOT change behavior of other links.

    // Ensure any links generated later (dynamically) will be handled by delegation above.

  })();
  </script>

</body>
</html>
