<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡¶™‡ßç‡¶∞‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶∏‡ßá‡¶¨‡¶æ ‚Äî ‡¶∏‡¶π‡¶ú ‡¶∏‡ßá‡¶¨‡¶æ</title>

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#00796b">
  <link rel="apple-touch-icon" href="icons/icon-192.png">

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <style>
    body {
      margin: 0;
      font-family: "Inter", "Noto Sans Bengali", sans-serif;
      background: linear-gradient(180deg, #f9fafb, #ecf0f1);
      color: #0b2540;
      padding-top: 100px;
    }

    /* ‡¶ò‡ßã‡¶∑‡¶£‡¶æ ‡¶¨‡¶æ‡¶∞ */
    .announcement-bar {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 95%;
      max-width: 900px;
      background: linear-gradient(135deg, #00796b, #26a69a, #ffb300);
      color: #fff;
      border-radius: 20px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25);
      padding: 10px 15px;
      text-align: center;
      z-index: 1000;
      backdrop-filter: blur(10px);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 6px;
    }

    .announcement-text {
      flex: 1;
      text-align: center;
    }

    .announcement-title {
      font-size: 16px;
      font-weight: 800;
      color: #ffffff;
      margin-bottom: 3px;
    }

    .announcement-message {
      font-size: 14px;
      font-weight: 600;
      padding: 6px 10px;
      border-radius: 10px;
      display: inline-block;
      transition: background 0.6s ease, color 0.6s ease;
    }

    /* Grid Layout */
    .wrap {
      max-width: 1000px;
      margin: auto;
      padding: 15px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 12px;
    }

    /* ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶ï‡¶æ‡¶∞‡ßç‡¶° */
    .service-card {
      background: #ffffff;
      border-radius: 15px;
      padding: 12px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.07);
      border: 1px solid #e5e7eb;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 250px;
    }

    .service-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
    }

    .service-title {
      font-size: 16px;
      font-weight: 700;
      text-align: center;
      background: linear-gradient(90deg, #00796b, #00bfa5);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 5px;
    }

    .service-details {
      background: linear-gradient(135deg, #eef2f3, #dfe9f3);
      color: #2c3e50;
      font-size: 13px;
      line-height: 1.4;
      border-radius: 10px;
      padding: 8px;
      box-shadow: inset 0 0 6px rgba(0,0,0,0.05);
      border-left: 3px solid #26a69a;
      flex-grow: 1;
      overflow: hidden;
    }

    .service-image {
      width: 100%;
      height: 90px;
      object-fit: contain;
      border-radius: 10px;
      background-color: #f8fafc;
      margin-top: 6px;
    }

    .service-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 6px;
    }

    .contact-icons {
      display: flex;
      gap: 6px;
    }

    .contact-icons a {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 14px;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .contact-icons a:hover {
      transform: scale(1.1);
      box-shadow: 0 0 10px rgba(0,0,0,0.25);
    }

    .whatsapp { background: #25D366; }
    .phone { background: #00796b; }
    .telegram { background: #229ED9; }
    .facebook { background: #1877F2; }

    .price-tag {
      padding: 4px 10px;
      border-radius: 15px;
      background: linear-gradient(90deg, #00796b, #26a69a);
      color: #ffffff;
      font-weight: 600;
      font-size: 12px;
      box-shadow: 0 3px 10px rgba(0, 121, 107, 0.3);
    }

    /* üß≠ ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶° ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶ï‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶® */
    .support-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: linear-gradient(135deg, #00796b, #00bfa5);
      color: #fff;
      font-weight: 700;
      font-size: 14px;
      padding: 12px 18px;
      border-radius: 30px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.25);
      display: flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
      z-index: 1500;
      transition: all 0.3s ease;
    }

    .support-button:hover {
      transform: scale(1.08);
      box-shadow: 0 10px 25px rgba(0,0,0,0.35);
    }

    .support-button i {
      font-size: 18px;
    }

    /* ‚úÖ ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶° ‡¶¨‡¶æ‡¶ü‡¶®: ‡¶è‡¶ï‡¶¶‡¶Æ ‡¶â‡¶™‡¶∞‡ßá-‡¶°‡¶æ‡¶®‡ßá (‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§) */
    .fixed-top-right {
      position: fixed;
      top: 10px; /* ‚ö†Ô∏è ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
      right: 20px;
      background: linear-gradient(135deg, #ff9800, #ffb74d);
      color: #fff;
      
      /* ‡¶¨‡¶æ‡¶ü‡¶®‡¶ü‡¶ø‡¶ï‡ßá ‡¶õ‡ßã‡¶ü ‡¶ì ‡¶ó‡ßã‡¶≤‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá */
      width: 40px; 
      height: 40px;
      border-radius: 50%;
      
      /* ‡¶Ü‡¶á‡¶ï‡¶®‡¶ï‡ßá ‡¶Æ‡¶æ‡¶ù‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶®‡¶§‡ßá */
      display: flex;
      justify-content: center;
      align-items: center;

      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
      z-index: 1001; /* ‡¶ò‡ßã‡¶∑‡¶£‡¶æ ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ (1000) ‡¶â‡¶™‡¶∞‡ßá ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
    }

    .fixed-top-right:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 15px rgba(0,0,0,0.3);
    }

    .fixed-top-right i {
      font-size: 16px;
    }
  </style>
</head>
<body>

  <div class="announcement-bar">
    <div class="announcement-text">
      <div class="announcement-title" id="announcementTitle">‚ú® ‡¶ò‡ßã‡¶∑‡¶£‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
      <div class="announcement-message" id="announcementMessage">‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...</div>
    </div>
  </div>

  <div class="wrap" id="servicesList">
    <div class="service-card">‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
  </div>

  <a href="https://wa.me/message/5HX345GEYAHVO1" target="_blank" class="support-button">
    <i class="fas fa-headset"></i> ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶ï‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü
  </a>
  
  <a href="#" id="fixedAnnouncementLink" class="fixed-top-right" target="_blank" style="display:none;">
    <i class="fas fa-link"></i>
  </a>


  <script>
  const SUPABASE_URL = "https://nzgejzlapyykhvcpypyr.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im56Z2VqemxhcHl5a2h2Y3B5cHlyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5ODE1MzksImV4cCI6MjA3NzU1NzUzOX0.JxXyESc-Y7VEi9WH2XkiXQIj8BgY-nzYOpfprMqIx4Y";
  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  const servicesList = document.getElementById("servicesList");
  const announcementTitle = document.getElementById("announcementTitle");
  const announcementMessage = document.getElementById("announcementMessage");
  
  // ‚úÖ ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶° ‡¶¨‡¶æ‡¶ü‡¶®‡ßá‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø
  const fixedAnnouncementLink = document.getElementById("fixedAnnouncementLink");


  const messageColors = [
    { bg: "#E3F2FD", color: "#0D47A1" },
    { bg: "#FFF3E0", color: "#E65100" },
    { bg: "#E8F5E9", color: "#1B5E20" },
    { bg: "#F3E5F5", color: "#4A148C" },
    { bg: "#FCE4EC", color: "#880E4F" },
    { bg: "#E0F7FA", color: "#006064" },
    { bg: "#FFFDE7", color: "#F57F17" }
  ];
  const randomColor = messageColors[Math.floor(Math.random() * messageColors.length)];
  announcementMessage.style.background = randomColor.bg;
  announcementMessage.style.color = randomColor.color;

  async function loadServices(){
  const contact = await loadContacts(); // ‚úÖ ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶ó‡ßá ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßã

  const { data, error } = await supabase.from("services").select("*").order("timestamp", { ascending: false });
  if(error){ servicesList.innerHTML = `<div class="service-card">‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ${error.message}</div>`; return; }
  if(!data.length){ servicesList.innerHTML = `<div class="service-card">‡¶ï‡ßã‡¶® ‡¶∏‡ßá‡¶¨‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</div>`; return; }

  servicesList.innerHTML = data.map(s => `
    <div class="service-card">
      <div class="service-title">${s.name}</div>
      <div class="service-details">${s.description || ''}</div>
      ${s.image_url ? `<img class="service-image" src="${s.image_url}" alt="Service Image" />` : ''}
      <div class="service-footer">
        <div class="contact-icons">
          <a href="${contact.whatsapp}" target="_blank" class="whatsapp"><i class="fab fa-whatsapp"></i></a>
          <a href="${contact.phone}" class="phone"><i class="fas fa-phone"></i></a>
          <a href="${contact.telegram}" target="_blank" class="telegram"><i class="fab fa-telegram"></i></a>
          <a href="${contact.facebook}" target="_blank" class="facebook"><i class="fab fa-facebook-f"></i></a>
        </div>
        <div class="price-tag">${s.price ? `‡ß≥ ${s.price}` : '‡¶´‡ßç‡¶∞‡¶ø'}</div>
      </div>
    </div>
  `).join('');
}

  async function loadAnnouncements(){
    const { data, error } = await supabase.from("announcements").select("*").order("timestamp", { ascending: false });
    if(error){ announcementTitle.textContent = "‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø"; announcementMessage.textContent = error.message; return; }
    if(!data.length){ 
      announcementTitle.textContent = "‡¶ò‡ßã‡¶∑‡¶£‡¶æ ‡¶®‡ßá‡¶á"; 
      announcementMessage.textContent = "‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶ò‡ßã‡¶∑‡¶£‡¶æ ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§"; 
      fixedAnnouncementLink.style.display = "none"; 
      return; 
    }

    const latest = data[0];
    announcementTitle.textContent = latest.title || "‡¶ò‡ßã‡¶∑‡¶£‡¶æ";
    announcementMessage.textContent = latest.content || "‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶®‡ßá‡¶á‡•§";

    if(latest.link){
      fixedAnnouncementLink.href = latest.link; 
      fixedAnnouncementLink.style.display = "flex"; 
    } else {
      fixedAnnouncementLink.style.display = "none";
    }
  }
  
  // ‚úÖ ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
async function loadContacts() {
  const { data, error } = await supabase.from("contacts").select("*").eq("name", "default").single();
  if (error) {
    console.error("‚ùå ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø:", error);
    return {
      whatsapp: "https://wa.me/message/5HX345GEYAHVO1",
      phone: "tel:0531267825",
      telegram: "https://t.me/prbashi",
      facebook: "https://www.facebook.com/share/17XjEWhr8a/"
    };
  }
  return data;
}

  // ‚úÖ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶ ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤‡¶ü‡¶æ‡¶á‡¶Æ ‡¶∏‡¶æ‡¶¨‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶®
  function setupRealtimeAnnouncements() {
    try {
      const channel = supabase.channel('realtime:announcements');

      channel.on(
        'postgres_changes',
        { event: '*', schema: 'public', table: 'announcements' },
        payload => {
          console.log('üì° ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤‡¶ü‡¶æ‡¶á‡¶Æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶∏‡¶®‡¶æ‡¶ï‡ßç‡¶§:', payload);
          loadAnnouncements();
        }
      );

      channel.subscribe((status) => {
        if (status === 'SUBSCRIBED') {
          console.log('‚úÖ ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤‡¶ü‡¶æ‡¶á‡¶Æ ‡¶ò‡ßã‡¶∑‡¶£‡¶æ ‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá');
        } else if (status === 'TIMED_OUT') {
          console.warn('‚ö†Ô∏è ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶ü‡¶æ‡¶á‡¶Æ‡¶Ü‡¶â‡¶ü ‚Äî ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
          reconnectRealtime();
        } else if (status === 'CLOSED') {
          console.warn('üîå ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶¨‡¶®‡ßç‡¶ß ‚Äî ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶∏‡¶Ç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
          reconnectRealtime();
        }
      });
    } catch (error) {
      console.error('‚ùå ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤‡¶ü‡¶æ‡¶á‡¶Æ ‡¶∏‡¶æ‡¶¨‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•:', error);
      setTimeout(setupRealtimeAnnouncements, 5000);
    }
  }

  function reconnectRealtime() {
    setTimeout(() => {
      console.log('üîÑ ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó‡ßá‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ö‡¶≤‡¶õ‡ßá...');
      setupRealtimeAnnouncements();
    }, 3000);
  }

  loadServices();
  loadAnnouncements();
  setupRealtimeAnnouncements();
  </script>
</body>
</html>
